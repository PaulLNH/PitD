{"version":3,"sources":["node_modules\\colyseus.js\\lib\\legacy.js","node_modules\\@gamestdio\\signals\\lib\\SlotList.js","node_modules\\@gamestdio\\signals\\lib\\Slot.js","node_modules\\@gamestdio\\signals\\lib\\OnceSignal.js","node_modules\\@gamestdio\\signals\\lib\\Signal.js","node_modules\\@gamestdio\\signals\\lib\\index.js","node_modules\\notepack.io\\browser\\encode.js","node_modules\\notepack.io\\browser\\decode.js","node_modules\\colyseus.js\\lib\\msgpack.js","node_modules\\@gamestdio\\websocket\\lib\\backoff.js","node_modules\\@gamestdio\\websocket\\lib\\index.js","node_modules\\colyseus.js\\lib\\Connection.js","node_modules\\colyseus.js\\lib\\Protocol.js","node_modules\\@gamestdio\\clock\\dist\\index.js","node_modules\\@gamestdio\\state-listener\\lib\\compare.js","node_modules\\@gamestdio\\state-listener\\lib\\StateContainer.js","node_modules\\@gamestdio\\state-listener\\lib\\index.js","node_modules\\fossil-delta\\fossil-delta.js","..\\..\\..\\..\\..\\Users\\plair\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\base64-js\\index.js","..\\..\\..\\..\\..\\Users\\plair\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\ieee754\\index.js","..\\..\\..\\..\\..\\Users\\plair\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\isarray\\index.js","..\\..\\..\\..\\..\\Users\\plair\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\buffer\\index.js","node_modules\\colyseus.js\\lib\\Room.js","node_modules\\colyseus.js\\lib\\Storage.js","node_modules\\colyseus.js\\lib\\Client.js","node_modules\\colyseus.js\\lib\\sync\\listeners.js","node_modules\\colyseus.js\\lib\\sync\\helpers.js","node_modules\\colyseus.js\\lib\\index.js","client.js"],"names":["ArrayBuffer","isView","a","buffer","Object","defineProperty","exports","value","encode","require","decode","createBackoff","backoff","exponential","attempt","delay","Math","floor","random","pow","fibonacci","current","prev","index","next","type","options","Backoff","func","attempts","initialDelay","prototype","setTimeout","onReady","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","_classCallCheck","instance","TypeError","WebSocketClient","url","protocols","arguments","undefined","reconnectEnabled","listeners","onBackoffReady","bind","connect","open","reconnect","isReconnect","binaryType","ws","WebSocket","onclose","onCloseCallback","onerror","onErrorCallback","onmessage","onMessageCallback","onopen","onOpenCallback","number","e","apply","code","close","reason","send","data","get","bufferedAmount","readyState","set","extensions","protocol","listener","CONNECTING","OPEN","CLOSING","CLOSED","default","__extends","extendStatics","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","create","websocket_1","msgpack","Connection","_super","autoConnect","_this","call","_enqueuedCalls","event","_i","_a","_b","method","args","push","Protocol","Clock","signals_1","state_listener_1","fossilDelta","Connection_1","Protocol_1","Room","name","clock","remoteClock","onJoin","Signal","onStateChange","onMessage","onError","onLeave","id","connection","add","removeAllListeners","endpoint","dispatch","console","warn","leave","LEAVE_ROOM","ROOM_DATA","removeAll","message","Uint8Array","JOIN_ROOM","sessionId","JOIN_ERROR","error","ROOM_STATE","state","remoteCurrentTime","remoteElapsedTime","setState","ROOM_STATE_PATCH","patch","encodedState","_previousState","currentTime","elapsedTime","start","binaryPatch","Buffer","from","StateContainer","getStorage","cc","sys","localStorage","window","setItem","getItem","callback","Promise","then","Room_1","Storage_1","Client","onOpen","onClose","rooms","connectingRooms","requestId","roomsAvailableRequests","hostname","colyseusid","join","roomName","room","createRoom","addOnce","rejoin","getAvailableRooms","removeRequest","rejectionTimeout","ROOM_LIST","roomsAvailable","clearTimeout","buildEndpoint","path","params","name_1","USER_ID","helpers_1","assign","property","propName","holderType","assignMultiple","properties","prop","getInstanceContainer","root","offset","len","objectListener","synchable","synchableRoot","parentSegment","change","operation","newType","bindListeners","variable","addCallback","rawRules","removeCallback","mapListener","rawPath","__mapParent","varListener","initializeSync","roomInstance","createBindings","syncMap","sync","syncObject","syncVar","syncList","proto","attr","$room","propertyKey","listen","op","methodName","listenersMap","bindProperties","segment","listenersToBind","_loop_1","Client_1","Colyseus","client","log"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;;;AAGA,IAAI,CAACA,YAAYC,MAAjB,EAAyB;AACrBD,gBAAYC,MAAZ,GAAqB,UAAUC,CAAV,EAAa;AAC9B,eAAOA,MAAM,IAAN,IAAc,QAAQA,CAAR,yCAAQA,CAAR,OAAe,QAA7B,IAAyCA,EAAEC,MAAF,YAAoBH,WAApE;AACH,KAFD;AAGH;;ACVD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzRA;;AACAI,OAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C,EAAEC,OAAO,IAAT,EAA7C;AACAD,QAAQE,MAAR,GAAiBC,QAAQ,4BAAR,CAAjB;AACAH,QAAQI,MAAR,GAAiBD,QAAQ,4BAAR,CAAjB;;ACHA;AAAaL,OAAOC,cAAP,CAAsBC,OAAtB,EAA8B,YAA9B,EAA2C,EAACC,OAAM,IAAP,EAA3C,EAAyDD,QAAQK,aAAR,GAAsBA,aAAtB,CAAoC,IAAIC,UAAQ,EAACC,aAAY,SAASA,WAAT,CAAqBC,OAArB,EAA6BC,KAA7B,EAAmC;AAAC,WAAOC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAcF,KAAKG,GAAL,CAAS,CAAT,EAAWL,OAAX,CAAd,GAAkCC,KAA7C,CAAP;AAA4D,GAA7G,EAA8GK,WAAU,SAASA,SAAT,CAAmBN,OAAnB,EAA2BC,KAA3B,EAAiC;AAAC,QAAIM,UAAQ,CAAZ,CAAc,IAAGP,UAAQO,OAAX,EAAmB;AAAC,UAAIC,OAAK,C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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3HA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"client.af22b982.map","sourceRoot":"..","sourcesContent":["//\n// Polyfills for legacy environments\n//\n/*\n * Support Android 4.4.x\n */\nif (!ArrayBuffer.isView) {\n    ArrayBuffer.isView = function (a) {\n        return a !== null && typeof (a) === 'object' && a.buffer instanceof ArrayBuffer;\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SlotList = (function () {\n    function SlotList(head, tail) {\n        if (tail === void 0) { tail = null; }\n        this.nonEmpty = false;\n        if (!head && !tail) {\n            if (SlotList.NIL) {\n                throw new Error(\"Parameters head and tail are null. Use the NIL element instead.\");\n            }\n            this.nonEmpty = false;\n        }\n        else if (!head) {\n            throw new Error(\"Parameter head cannot be null.\");\n        }\n        else {\n            this.head = head;\n            this.tail = tail || SlotList.NIL;\n            this.nonEmpty = true;\n        }\n    }\n    Object.defineProperty(SlotList.prototype, \"length\", {\n        get: function () {\n            if (!this.nonEmpty) {\n                return 0;\n            }\n            if (this.tail === SlotList.NIL) {\n                return 1;\n            }\n            var result = 0;\n            var p = this;\n            while (p.nonEmpty) {\n                ++result;\n                p = p.tail;\n            }\n            return result;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SlotList.prototype.prepend = function (slot) {\n        return new SlotList(slot, this);\n    };\n    SlotList.prototype.append = function (slot) {\n        if (!slot) {\n            return this;\n        }\n        if (!this.nonEmpty) {\n            return new SlotList(slot);\n        }\n        if (this.tail === SlotList.NIL) {\n            return new SlotList(slot).prepend(this.head);\n        }\n        var wholeClone = new SlotList(this.head);\n        var subClone = wholeClone;\n        var current = this.tail;\n        while (current.nonEmpty) {\n            subClone = subClone.tail = new SlotList(current.head);\n            current = current.tail;\n        }\n        subClone.tail = new SlotList(slot);\n        return wholeClone;\n    };\n    SlotList.prototype.insertWithPriority = function (slot) {\n        if (!this.nonEmpty) {\n            return new SlotList(slot);\n        }\n        var priority = slot.priority;\n        if (priority > this.head.priority) {\n            return this.prepend(slot);\n        }\n        var wholeClone = new SlotList(this.head);\n        var subClone = wholeClone;\n        var current = this.tail;\n        while (current.nonEmpty) {\n            if (priority > current.head.priority) {\n                subClone.tail = current.prepend(slot);\n                return wholeClone;\n            }\n            subClone = subClone.tail = new SlotList(current.head);\n            current = current.tail;\n        }\n        subClone.tail = new SlotList(slot);\n        return wholeClone;\n    };\n    SlotList.prototype.filterNot = function (listener) {\n        if (!this.nonEmpty || listener == null) {\n            return this;\n        }\n        if (listener === this.head.listener) {\n            return this.tail;\n        }\n        var wholeClone = new SlotList(this.head);\n        var subClone = wholeClone;\n        var current = this.tail;\n        while (current.nonEmpty) {\n            if (current.head.listener === listener) {\n                subClone.tail = current.tail;\n                return wholeClone;\n            }\n            subClone = subClone.tail = new SlotList(current.head);\n            current = current.tail;\n        }\n        return this;\n    };\n    SlotList.prototype.contains = function (listener) {\n        if (!this.nonEmpty) {\n            return false;\n        }\n        var p = this;\n        while (p.nonEmpty) {\n            if (p.head.listener === listener) {\n                return true;\n            }\n            p = p.tail;\n        }\n        return false;\n    };\n    SlotList.prototype.find = function (listener) {\n        if (!this.nonEmpty) {\n            return null;\n        }\n        var p = this;\n        while (p.nonEmpty) {\n            if (p.head.listener === listener) {\n                return p.head;\n            }\n            p = p.tail;\n        }\n        return null;\n    };\n    SlotList.prototype.toString = function () {\n        var buffer = \"\";\n        var p = this;\n        while (p.nonEmpty) {\n            buffer += p.head + \" -> \";\n            p = p.tail;\n        }\n        buffer += \"NIL\";\n        return \"[List \" + buffer + \"]\";\n    };\n    SlotList.NIL = new SlotList(null, null);\n    return SlotList;\n}());\nexports.SlotList = SlotList;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Slot = (function () {\n    function Slot(listener, signal, once, priority) {\n        if (once === void 0) { once = false; }\n        if (priority === void 0) { priority = 0; }\n        this._enabled = true;\n        this._once = false;\n        this._priority = 0;\n        this._listener = listener;\n        this._once = once;\n        this._signal = signal;\n        this._priority = priority;\n        this.verifyListener(listener);\n    }\n    Slot.prototype.execute0 = function () {\n        if (!this._enabled) {\n            return;\n        }\n        if (this._once) {\n            this.remove();\n        }\n        if (this._params && this._params.length) {\n            this._listener.apply(null, this._params);\n            return;\n        }\n        this._listener();\n    };\n    Slot.prototype.execute1 = function (value) {\n        if (!this._enabled) {\n            return;\n        }\n        if (this._once) {\n            this.remove();\n        }\n        if (this._params && this._params.length) {\n            this._listener.apply(null, [value].concat(this._params));\n            return;\n        }\n        this._listener(value);\n    };\n    Slot.prototype.execute = function (valueObjects) {\n        if (!this._enabled) {\n            return;\n        }\n        if (this._once) {\n            this.remove();\n        }\n        if (this._params && this._params.length) {\n            valueObjects = valueObjects.concat(this._params);\n        }\n        var numValueObjects = valueObjects.length;\n        if (numValueObjects === 0) {\n            this._listener();\n        }\n        else if (numValueObjects === 1) {\n            this._listener(valueObjects[0]);\n        }\n        else if (numValueObjects === 2) {\n            this._listener(valueObjects[0], valueObjects[1]);\n        }\n        else if (numValueObjects === 3) {\n            this._listener(valueObjects[0], valueObjects[1], valueObjects[2]);\n        }\n        else {\n            this._listener.apply(null, valueObjects);\n        }\n    };\n    Object.defineProperty(Slot.prototype, \"listener\", {\n        get: function () {\n            return this._listener;\n        },\n        set: function (value) {\n            if (null == value) {\n                throw new Error(\"Given listener is null.\\nDid you want to set enabled to false instead?\");\n            }\n            this.verifyListener(value);\n            this._listener = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Slot.prototype, \"once\", {\n        get: function () {\n            return this._once;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Slot.prototype, \"priority\", {\n        get: function () {\n            return this._priority;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Slot.prototype.toString = function () {\n        return (\"[Slot listener: \" +\n            this._listener +\n            \", once: \" +\n            this._once +\n            \", priority: \" +\n            this._priority +\n            \", enabled: \" +\n            this._enabled +\n            \"]\");\n    };\n    Object.defineProperty(Slot.prototype, \"enabled\", {\n        get: function () {\n            return this._enabled;\n        },\n        set: function (value) {\n            this._enabled = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Slot.prototype, \"params\", {\n        get: function () {\n            return this._params;\n        },\n        set: function (value) {\n            this._params = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Slot.prototype.remove = function () {\n        this._signal.remove(this._listener);\n    };\n    Slot.prototype.verifyListener = function (listener) {\n        if (null == listener) {\n            throw new Error(\"Given listener is null.\");\n        }\n        if (null == this._signal) {\n            throw new Error(\"Internal signal reference has not been set yet.\");\n        }\n    };\n    return Slot;\n}());\nexports.Slot = Slot;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SlotList_1 = require(\"./SlotList\");\nvar Slot_1 = require(\"./Slot\");\nvar OnceSignal = (function () {\n    function OnceSignal() {\n        var valueClasses = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            valueClasses[_i] = arguments[_i];\n        }\n        this.slots = SlotList_1.SlotList.NIL;\n        this.valueClasses = valueClasses.length === 1 && valueClasses[0] instanceof Array ? valueClasses[0] : valueClasses;\n    }\n    Object.defineProperty(OnceSignal.prototype, \"valueClasses\", {\n        get: function () {\n            return this._valueClasses;\n        },\n        set: function (value) {\n            this._valueClasses = value ? value.slice() : [];\n            for (var i = this._valueClasses.length; i--;) {\n                if (!(this._valueClasses[i] instanceof Object)) {\n                    throw new Error(\"Invalid valueClasses argument: \" +\n                        \"item at index \" +\n                        i +\n                        \" should be a Class but was:<\" +\n                        this._valueClasses[i] +\n                        \">.\" +\n                        this._valueClasses[i]);\n                }\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(OnceSignal.prototype, \"numListeners\", {\n        get: function () {\n            return this.slots.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    OnceSignal.prototype.addOnce = function (listener) {\n        return this.registerListener(listener, true);\n    };\n    OnceSignal.prototype.once = function (listener) {\n        return this.addOnce(listener);\n    };\n    OnceSignal.prototype.remove = function (listener) {\n        var slot = this.slots.find(listener);\n        if (!slot) {\n            return null;\n        }\n        this.slots = this.slots.filterNot(listener);\n        return slot;\n    };\n    OnceSignal.prototype.removeAll = function () {\n        this.slots = SlotList_1.SlotList.NIL;\n    };\n    OnceSignal.prototype.dispatch = function () {\n        var valueObjects = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            valueObjects[_i] = arguments[_i];\n        }\n        var numValueClasses = this._valueClasses.length;\n        var numValueObjects = valueObjects.length;\n        if (numValueObjects < numValueClasses) {\n            throw new Error(\"Incorrect number of arguments. \" + \"Expected at least \" + numValueClasses + \" but received \" + numValueObjects + \".\");\n        }\n        for (var i = 0; i < numValueClasses; i++) {\n            if (valueObjects[i] === null ||\n                (valueObjects[i] instanceof this._valueClasses[i] || valueObjects[i].constructor === this._valueClasses[i])) {\n                continue;\n            }\n            throw new Error(\"Value object <\" + valueObjects[i] + \"> is not an instance of <\" + this._valueClasses[i] + \">.\");\n        }\n        var slotsToProcess = this.slots;\n        if (slotsToProcess.nonEmpty) {\n            while (slotsToProcess.nonEmpty) {\n                slotsToProcess.head.execute(valueObjects);\n                slotsToProcess = slotsToProcess.tail;\n            }\n        }\n    };\n    OnceSignal.prototype.registerListener = function (listener, once) {\n        if (once === void 0) { once = false; }\n        if (this.registrationPossible(listener, once)) {\n            var newSlot = new Slot_1.Slot(listener, this, once);\n            this.slots = this.slots.prepend(newSlot);\n            return newSlot;\n        }\n        return this.slots.find(listener);\n    };\n    OnceSignal.prototype.registrationPossible = function (listener, once) {\n        if (!this.slots.nonEmpty) {\n            return true;\n        }\n        var existingSlot = this.slots.find(listener);\n        if (!existingSlot) {\n            return true;\n        }\n        if (existingSlot.once !== once) {\n            throw new Error(\"You cannot addOnce() then add() the same listener without removing the relationship first.\");\n        }\n        return false;\n    };\n    return OnceSignal;\n}());\nexports.OnceSignal = OnceSignal;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar OnceSignal_1 = require(\"./OnceSignal\");\nvar Signal = (function (_super) {\n    __extends(Signal, _super);\n    function Signal() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Signal.prototype.add = function (listener) {\n        return this.registerListener(listener);\n    };\n    return Signal;\n}(OnceSignal_1.OnceSignal));\nexports.Signal = Signal;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar OnceSignal_1 = require(\"./OnceSignal\");\nexports.OnceSignal = OnceSignal_1.OnceSignal;\nvar Signal_1 = require(\"./Signal\");\nexports.Signal = Signal_1.Signal;\nvar Slot_1 = require(\"./Slot\");\nexports.Slot = Slot_1.Slot;\nvar SlotList_1 = require(\"./SlotList\");\nexports.SlotList = SlotList_1.SlotList;\n","'use strict';\n\nfunction utf8Write(view, offset, str) {\n  var c = 0;\n  for (var i = 0, l = str.length; i < l; i++) {\n    c = str.charCodeAt(i);\n    if (c < 0x80) {\n      view.setUint8(offset++, c);\n    }\n    else if (c < 0x800) {\n      view.setUint8(offset++, 0xc0 | (c >> 6));\n      view.setUint8(offset++, 0x80 | (c & 0x3f));\n    }\n    else if (c < 0xd800 || c >= 0xe000) {\n      view.setUint8(offset++, 0xe0 | (c >> 12));\n      view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\n      view.setUint8(offset++, 0x80 | (c & 0x3f));\n    }\n    else {\n      i++;\n      c = 0x10000 + (((c & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\n      view.setUint8(offset++, 0xf0 | (c >> 18));\n      view.setUint8(offset++, 0x80 | (c >> 12) & 0x3f);\n      view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\n      view.setUint8(offset++, 0x80 | (c & 0x3f));\n    }\n  }\n}\n\nfunction utf8Length(str) {\n  var c = 0, length = 0;\n  for (var i = 0, l = str.length; i < l; i++) {\n    c = str.charCodeAt(i);\n    if (c < 0x80) {\n      length += 1;\n    }\n    else if (c < 0x800) {\n      length += 2;\n    }\n    else if (c < 0xd800 || c >= 0xe000) {\n      length += 3;\n    }\n    else {\n      i++;\n      length += 4;\n    }\n  }\n  return length;\n}\n\nfunction _encode(bytes, defers, value) {\n  var type = typeof value, i = 0, l = 0, hi = 0, lo = 0, length = 0, size = 0;\n\n  if (type === 'string') {\n    length = utf8Length(value);\n\n    // fixstr\n    if (length < 0x20) {\n      bytes.push(length | 0xa0);\n      size = 1;\n    }\n    // str 8\n    else if (length < 0x100) {\n      bytes.push(0xd9, length);\n      size = 2;\n    }\n    // str 16\n    else if (length < 0x10000) {\n      bytes.push(0xda, length >> 8, length);\n      size = 3;\n    }\n    // str 32\n    else if (length < 0x100000000) {\n      bytes.push(0xdb, length >> 24, length >> 16, length >> 8, length);\n      size = 5;\n    } else {\n      throw new Error('String too long');\n    }\n    defers.push({ str: value, length: length, offset: bytes.length });\n    return size + length;\n  }\n  if (type === 'number') {\n    // TODO: encode to float 32?\n\n    // float 64\n    if (Math.floor(value) !== value || !isFinite(value)) {\n      bytes.push(0xcb);\n      defers.push({ float: value, length: 8, offset: bytes.length });\n      return 9;\n    }\n\n    if (value >= 0) {\n      // positive fixnum\n      if (value < 0x80) {\n        bytes.push(value);\n        return 1;\n      }\n      // uint 8\n      if (value < 0x100) {\n        bytes.push(0xcc, value);\n        return 2;\n      }\n      // uint 16\n      if (value < 0x10000) {\n        bytes.push(0xcd, value >> 8, value);\n        return 3;\n      }\n      // uint 32\n      if (value < 0x100000000) {\n        bytes.push(0xce, value >> 24, value >> 16, value >> 8, value);\n        return 5;\n      }\n      // uint 64\n      hi = (value / Math.pow(2, 32)) >> 0;\n      lo = value >>> 0;\n      bytes.push(0xcf, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n      return 9;\n    } else {\n      // negative fixnum\n      if (value >= -0x20) {\n        bytes.push(value);\n        return 1;\n      }\n      // int 8\n      if (value >= -0x80) {\n        bytes.push(0xd0, value);\n        return 2;\n      }\n      // int 16\n      if (value >= -0x8000) {\n        bytes.push(0xd1, value >> 8, value);\n        return 3;\n      }\n      // int 32\n      if (value >= -0x80000000) {\n        bytes.push(0xd2, value >> 24, value >> 16, value >> 8, value);\n        return 5;\n      }\n      // int 64\n      hi = Math.floor(value / Math.pow(2, 32));\n      lo = value >>> 0;\n      bytes.push(0xd3, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n      return 9;\n    }\n  }\n  if (type === 'object') {\n    // nil\n    if (value === null) {\n      bytes.push(0xc0);\n      return 1;\n    }\n\n    if (Array.isArray(value)) {\n      length = value.length;\n\n      // fixarray\n      if (length < 0x10) {\n        bytes.push(length | 0x90);\n        size = 1;\n      }\n      // array 16\n      else if (length < 0x10000) {\n        bytes.push(0xdc, length >> 8, length);\n        size = 3;\n      }\n      // array 32\n      else if (length < 0x100000000) {\n        bytes.push(0xdd, length >> 24, length >> 16, length >> 8, length);\n        size = 5;\n      } else {\n        throw new Error('Array too large');\n      }\n      for (i = 0; i < length; i++) {\n        size += _encode(bytes, defers, value[i]);\n      }\n      return size;\n    }\n\n    // fixext 8 / Date\n    if (value instanceof Date) {\n      var time = value.getTime();\n      hi = Math.floor(time / Math.pow(2, 32));\n      lo = time >>> 0;\n      bytes.push(0xd7, 0, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n      return 10;\n    }\n\n    if (value instanceof ArrayBuffer) {\n      length = value.byteLength;\n\n      // bin 8\n      if (length < 0x100) {\n        bytes.push(0xc4, length);\n        size = 2;\n      } else\n      // bin 16\n      if (length < 0x10000) {\n        bytes.push(0xc5, length >> 8, length);\n        size = 3;\n      } else\n      // bin 32\n      if (length < 0x100000000) {\n        bytes.push(0xc6, length >> 24, length >> 16, length >> 8, length);\n        size = 5;\n      } else {\n        throw new Error('Buffer too large');\n      }\n      defers.push({ bin: value, length: length, offset: bytes.length });\n      return size + length;\n    }\n\n    if (typeof value.toJSON === 'function') {\n      return _encode(bytes, defers, value.toJSON());\n    }\n\n    var keys = [], key = '';\n\n    var allKeys = Object.keys(value);\n    for (i = 0, l = allKeys.length; i < l; i++) {\n      key = allKeys[i];\n      if (typeof value[key] !== 'function') {\n        keys.push(key);\n      }\n    }\n    length = keys.length;\n\n    // fixmap\n    if (length < 0x10) {\n      bytes.push(length | 0x80);\n      size = 1;\n    }\n    // map 16\n    else if (length < 0x10000) {\n      bytes.push(0xde, length >> 8, length);\n      size = 3;\n    }\n    // map 32\n    else if (length < 0x100000000) {\n      bytes.push(0xdf, length >> 24, length >> 16, length >> 8, length);\n      size = 5;\n    } else {\n      throw new Error('Object too large');\n    }\n\n    for (i = 0; i < length; i++) {\n      key = keys[i];\n      size += _encode(bytes, defers, key);\n      size += _encode(bytes, defers, value[key]);\n    }\n    return size;\n  }\n  // false/true\n  if (type === 'boolean') {\n    bytes.push(value ? 0xc3 : 0xc2);\n    return 1;\n  }\n  // fixext 1 / undefined\n  if (type === 'undefined') {\n    bytes.push(0xd4, 0, 0);\n    return 3;\n  }\n  throw new Error('Could not encode');\n}\n\nfunction encode(value) {\n  var bytes = [];\n  var defers = [];\n  var size = _encode(bytes, defers, value);\n  var buf = new ArrayBuffer(size);\n  var view = new DataView(buf);\n\n  var deferIndex = 0;\n  var deferWritten = 0;\n  var nextOffset = -1;\n  if (defers.length > 0) {\n    nextOffset = defers[0].offset;\n  }\n\n  var defer, deferLength = 0, offset = 0;\n  for (var i = 0, l = bytes.length; i < l; i++) {\n    view.setUint8(deferWritten + i, bytes[i]);\n    if (i + 1 !== nextOffset) { continue; }\n    defer = defers[deferIndex];\n    deferLength = defer.length;\n    offset = deferWritten + nextOffset;\n    if (defer.bin) {\n      var bin = new Uint8Array(defer.bin);\n      for (var j = 0; j < deferLength; j++) {\n        view.setUint8(offset + j, bin[j]);\n      }\n    } else if (defer.str) {\n      utf8Write(view, offset, defer.str);\n    } else if (defer.float !== undefined) {\n      view.setFloat64(offset, defer.float);\n    }\n    deferIndex++;\n    deferWritten += deferLength;\n    if (defers[deferIndex]) {\n      nextOffset = defers[deferIndex].offset;\n    }\n  }\n  return buf;\n}\n\nmodule.exports = encode;\n","'use strict';\n\nfunction Decoder(buffer) {\n  this.offset = 0;\n  if (buffer instanceof ArrayBuffer) {\n    this.buffer = buffer;\n    this.view = new DataView(this.buffer);\n  } else if (ArrayBuffer.isView(buffer)) {\n    this.buffer = buffer.buffer;\n    this.view = new DataView(this.buffer, buffer.byteOffset, buffer.byteLength);\n  } else {\n    throw new Error('Invalid argument');\n  }\n}\n\nfunction utf8Read(view, offset, length) {\n  var string = '', chr = 0;\n  for (var i = offset, end = offset + length; i < end; i++) {\n    var byte = view.getUint8(i);\n    if ((byte & 0x80) === 0x00) {\n      string += String.fromCharCode(byte);\n      continue;\n    }\n    if ((byte & 0xe0) === 0xc0) {\n      string += String.fromCharCode(\n        ((byte & 0x1f) << 6) |\n        (view.getUint8(++i) & 0x3f)\n      );\n      continue;\n    }\n    if ((byte & 0xf0) === 0xe0) {\n      string += String.fromCharCode(\n        ((byte & 0x0f) << 12) |\n        ((view.getUint8(++i) & 0x3f) << 6) |\n        ((view.getUint8(++i) & 0x3f) << 0)\n      );\n      continue;\n    }\n    if ((byte & 0xf8) === 0xf0) {\n      chr = ((byte & 0x07) << 18) |\n        ((view.getUint8(++i) & 0x3f) << 12) |\n        ((view.getUint8(++i) & 0x3f) << 6) |\n        ((view.getUint8(++i) & 0x3f) << 0);\n      if (chr >= 0x010000) { // surrogate pair\n        chr -= 0x010000;\n        string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n      } else {\n        string += String.fromCharCode(chr);\n      }\n      continue;\n    }\n    throw new Error('Invalid byte ' + byte.toString(16));\n  }\n  return string;\n}\n\nDecoder.prototype.array = function (length) {\n  var value = new Array(length);\n  for (var i = 0; i < length; i++) {\n    value[i] = this.parse();\n  }\n  return value;\n};\n\nDecoder.prototype.map = function (length) {\n  var key = '', value = {};\n  for (var i = 0; i < length; i++) {\n    key = this.parse();\n    value[key] = this.parse();\n  }\n  return value;\n};\n\nDecoder.prototype.str = function (length) {\n  var value = utf8Read(this.view, this.offset, length);\n  this.offset += length;\n  return value;\n};\n\nDecoder.prototype.bin = function (length) {\n  var value = this.buffer.slice(this.offset, this.offset + length);\n  this.offset += length;\n  return value;\n};\n\nDecoder.prototype.parse = function () {\n  var prefix = this.view.getUint8(this.offset++);\n  var value, length = 0, type = 0, hi = 0, lo = 0;\n\n  if (prefix < 0xc0) {\n    // positive fixint\n    if (prefix < 0x80) {\n      return prefix;\n    }\n    // fixmap\n    if (prefix < 0x90) {\n      return this.map(prefix & 0x0f);\n    }\n    // fixarray\n    if (prefix < 0xa0) {\n      return this.array(prefix & 0x0f);\n    }\n    // fixstr\n    return this.str(prefix & 0x1f);\n  }\n\n  // negative fixint\n  if (prefix > 0xdf) {\n    return (0xff - prefix + 1) * -1;\n  }\n\n  switch (prefix) {\n    // nil\n    case 0xc0:\n      return null;\n    // false\n    case 0xc2:\n      return false;\n    // true\n    case 0xc3:\n      return true;\n\n    // bin\n    case 0xc4:\n      length = this.view.getUint8(this.offset);\n      this.offset += 1;\n      return this.bin(length);\n    case 0xc5:\n      length = this.view.getUint16(this.offset);\n      this.offset += 2;\n      return this.bin(length);\n    case 0xc6:\n      length = this.view.getUint32(this.offset);\n      this.offset += 4;\n      return this.bin(length);\n\n    // ext\n    case 0xc7:\n      length = this.view.getUint8(this.offset);\n      type = this.view.getInt8(this.offset + 1);\n      this.offset += 2;\n      return [type, this.bin(length)];\n    case 0xc8:\n      length = this.view.getUint16(this.offset);\n      type = this.view.getInt8(this.offset + 2);\n      this.offset += 3;\n      return [type, this.bin(length)];\n    case 0xc9:\n      length = this.view.getUint32(this.offset);\n      type = this.view.getInt8(this.offset + 4);\n      this.offset += 5;\n      return [type, this.bin(length)];\n\n    // float\n    case 0xca:\n      value = this.view.getFloat32(this.offset);\n      this.offset += 4;\n      return value;\n    case 0xcb:\n      value = this.view.getFloat64(this.offset);\n      this.offset += 8;\n      return value;\n\n    // uint\n    case 0xcc:\n      value = this.view.getUint8(this.offset);\n      this.offset += 1;\n      return value;\n    case 0xcd:\n      value = this.view.getUint16(this.offset);\n      this.offset += 2;\n      return value;\n    case 0xce:\n      value = this.view.getUint32(this.offset);\n      this.offset += 4;\n      return value;\n    case 0xcf:\n      hi = this.view.getUint32(this.offset) * Math.pow(2, 32);\n      lo = this.view.getUint32(this.offset + 4);\n      this.offset += 8;\n      return hi + lo;\n\n    // int\n    case 0xd0:\n      value = this.view.getInt8(this.offset);\n      this.offset += 1;\n      return value;\n    case 0xd1:\n      value = this.view.getInt16(this.offset);\n      this.offset += 2;\n      return value;\n    case 0xd2:\n      value = this.view.getInt32(this.offset);\n      this.offset += 4;\n      return value;\n    case 0xd3:\n      hi = this.view.getInt32(this.offset) * Math.pow(2, 32);\n      lo = this.view.getUint32(this.offset + 4);\n      this.offset += 8;\n      return hi + lo;\n\n    // fixext\n    case 0xd4:\n      type = this.view.getInt8(this.offset);\n      this.offset += 1;\n      if (type === 0x00) {\n        this.offset += 1;\n        return void 0;\n      }\n      return [type, this.bin(1)];\n    case 0xd5:\n      type = this.view.getInt8(this.offset);\n      this.offset += 1;\n      return [type, this.bin(2)];\n    case 0xd6:\n      type = this.view.getInt8(this.offset);\n      this.offset += 1;\n      return [type, this.bin(4)];\n    case 0xd7:\n      type = this.view.getInt8(this.offset);\n      this.offset += 1;\n      if (type === 0x00) {\n        hi = this.view.getInt32(this.offset) * Math.pow(2, 32);\n        lo = this.view.getUint32(this.offset + 4);\n        this.offset += 8;\n        return new Date(hi + lo);\n      }\n      return [type, this.bin(8)];\n    case 0xd8:\n      type = this.view.getInt8(this.offset);\n      this.offset += 1;\n      return [type, this.bin(16)];\n\n    // str\n    case 0xd9:\n      length = this.view.getUint8(this.offset);\n      this.offset += 1;\n      return this.str(length);\n    case 0xda:\n      length = this.view.getUint16(this.offset);\n      this.offset += 2;\n      return this.str(length);\n    case 0xdb:\n      length = this.view.getUint32(this.offset);\n      this.offset += 4;\n      return this.str(length);\n\n    // array\n    case 0xdc:\n      length = this.view.getUint16(this.offset);\n      this.offset += 2;\n      return this.array(length);\n    case 0xdd:\n      length = this.view.getUint32(this.offset);\n      this.offset += 4;\n      return this.array(length);\n\n    // map\n    case 0xde:\n      length = this.view.getUint16(this.offset);\n      this.offset += 2;\n      return this.map(length);\n    case 0xdf:\n      length = this.view.getUint32(this.offset);\n      this.offset += 4;\n      return this.map(length);\n  }\n\n  throw new Error('Could not parse');\n};\n\nfunction decode(buffer) {\n  var decoder = new Decoder(buffer);\n  var value = decoder.parse();\n  if (decoder.offset !== buffer.byteLength) {\n    throw new Error((buffer.byteLength - decoder.offset) + ' trailing bytes');\n  }\n  return value;\n}\n\nmodule.exports = decode;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.encode = require('notepack.io/browser/encode');\nexports.decode = require('notepack.io/browser/decode');\n","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports.createBackoff=createBackoff;var backoff={exponential:function exponential(attempt,delay){return Math.floor(Math.random()*Math.pow(2,attempt)*delay);},fibonacci:function fibonacci(attempt,delay){var current=1;if(attempt>current){var prev=1,current=2;for(var index=2;index<attempt;index++){var next=prev+current;prev=current;current=next;}}return Math.floor(Math.random()*current*delay);}};function createBackoff(type,options){return new Backoff(backoff[type],options);}function Backoff(func,options){this.func=func;this.attempts=0;this.delay=typeof options.initialDelay!==\"undefined\"?options.initialDelay:100;}Backoff.prototype.backoff=function(){setTimeout(this.onReady,this.func(++this.attempts,this.delay));};","'use strict';Object.defineProperty(exports,\"__esModule\",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}var createBackoff=require('./backoff').createBackoff;var WebSocketClient=function(){/**\n   * @param url DOMString The URL to which to connect; this should be the URL to which the WebSocket server will respond.\n   * @param protocols DOMString|DOMString[] Either a single protocol string or an array of protocol strings. These strings are used to indicate sub-protocols, so that a single server can implement multiple WebSocket sub-protocols (for example, you might want one server to be able to handle different types of interactions depending on the specified protocol). If you don't specify a protocol string, an empty string is assumed.\n   */function WebSocketClient(url,protocols){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};_classCallCheck(this,WebSocketClient);this.url=url;this.protocols=protocols;this.reconnectEnabled=true;this.listeners={};this.backoff=createBackoff(options.backoff||'exponential',options);this.backoff.onReady=this.onBackoffReady.bind(this);if(typeof options.connect===\"undefined\"||options.connect){this.open();}}_createClass(WebSocketClient,[{key:'open',value:function open(){var reconnect=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.isReconnect=reconnect;// keep binaryType used on previous WebSocket connection\nvar binaryType=this.ws&&this.ws.binaryType;this.ws=new WebSocket(this.url,this.protocols);this.ws.onclose=this.onCloseCallback.bind(this);this.ws.onerror=this.onErrorCallback.bind(this);this.ws.onmessage=this.onMessageCallback.bind(this);this.ws.onopen=this.onOpenCallback.bind(this);if(binaryType){this.ws.binaryType=binaryType;}}/**\n   * @ignore\n   */},{key:'onBackoffReady',value:function onBackoffReady(number,delay){// console.log(\"onBackoffReady\", number + ' ' + delay + 'ms');\nthis.open(true);}/**\n   * @ignore\n   */},{key:'onCloseCallback',value:function onCloseCallback(e){if(!this.isReconnect&&this.listeners['onclose']){this.listeners['onclose'].apply(null,arguments);}if(this.reconnectEnabled&&e.code<3000){this.backoff.backoff();}}/**\n   * @ignore\n   */},{key:'onErrorCallback',value:function onErrorCallback(){if(this.listeners['onerror']){this.listeners['onerror'].apply(null,arguments);}}/**\n   * @ignore\n   */},{key:'onMessageCallback',value:function onMessageCallback(){if(this.listeners['onmessage']){this.listeners['onmessage'].apply(null,arguments);}}/**\n   * @ignore\n   */},{key:'onOpenCallback',value:function onOpenCallback(){if(this.listeners['onopen']){this.listeners['onopen'].apply(null,arguments);}if(this.isReconnect&&this.listeners['onreconnect']){this.listeners['onreconnect'].apply(null,arguments);}this.isReconnect=false;}/**\n   * The number of bytes of data that have been queued using calls to send()\n   * but not yet transmitted to the network. This value does not reset to zero\n   * when the connection is closed; if you keep calling send(), this will\n   * continue to climb.\n   *\n   * @type unsigned long\n   * @readonly\n   */},{key:'close',/**\n   * Closes the WebSocket connection or connection attempt, if any. If the\n   * connection is already CLOSED, this method does nothing.\n   *\n   * @param code A numeric value indicating the status code explaining why the connection is being closed. If this parameter is not specified, a default value of 1000 (indicating a normal \"transaction complete\" closure) is assumed. See the list of status codes on the CloseEvent page for permitted values.\n   * @param reason A human-readable string explaining why the connection is closing. This string must be no longer than 123 bytes of UTF-8 text (not characters).\n   *\n   * @return void\n   */value:function close(code,reason){if(typeof code=='undefined'){code=1000;}this.reconnectEnabled=false;this.ws.close(code,reason);}/**\n   * Transmits data to the server over the WebSocket connection.\n   * @param data DOMString|ArrayBuffer|Blob\n   * @return void\n   */},{key:'send',value:function send(data){this.ws.send(data);}/**\n   * An event listener to be called when the WebSocket connection's readyState changes to CLOSED. The listener receives a CloseEvent named \"close\".\n   * @param listener EventListener\n   */},{key:'bufferedAmount',get:function get(){return this.ws.bufferedAmount;}/**\n   * The current state of the connection; this is one of the Ready state constants.\n   * @type unsigned short\n   * @readonly\n   */},{key:'readyState',get:function get(){return this.ws.readyState;}/**\n   * A string indicating the type of binary data being transmitted by the\n   * connection. This should be either \"blob\" if DOM Blob objects are being\n   * used or \"arraybuffer\" if ArrayBuffer objects are being used.\n   * @type DOMString\n   */},{key:'binaryType',get:function get(){return this.ws.binaryType;},set:function set(binaryType){this.ws.binaryType=binaryType;}/**\n   * The extensions selected by the server. This is currently only the empty\n   * string or a list of extensions as negotiated by the connection.\n   * @type DOMString\n   */},{key:'extensions',get:function get(){return this.ws.extensions;},set:function set(extensions){this.ws.extensions=extensions;}/**\n   * A string indicating the name of the sub-protocol the server selected;\n   * this will be one of the strings specified in the protocols parameter when\n   * creating the WebSocket object.\n   * @type DOMString\n   */},{key:'protocol',get:function get(){return this.ws.protocol;},set:function set(protocol){this.ws.protocol=protocol;}},{key:'onclose',set:function set(listener){this.listeners['onclose']=listener;},get:function get(){return this.listeners['onclose'];}/**\n   * An event listener to be called when an error occurs. This is a simple event named \"error\".\n   * @param listener EventListener\n   */},{key:'onerror',set:function set(listener){this.listeners['onerror']=listener;},get:function get(){return this.listeners['onerror'];}/**\n   * An event listener to be called when a message is received from the server. The listener receives a MessageEvent named \"message\".\n   * @param listener EventListener\n   */},{key:'onmessage',set:function set(listener){this.listeners['onmessage']=listener;},get:function get(){return this.listeners['onmessage'];}/**\n   * An event listener to be called when the WebSocket connection's readyState changes to OPEN; this indicates that the connection is ready to send and receive data. The event is a simple one with the name \"open\".\n   * @param listener EventListener\n   */},{key:'onopen',set:function set(listener){this.listeners['onopen']=listener;},get:function get(){return this.listeners['onopen'];}/**\n   * @param listener EventListener\n   */},{key:'onreconnect',set:function set(listener){this.listeners['onreconnect']=listener;},get:function get(){return this.listeners['onreconnect'];}}]);return WebSocketClient;}();/**\n * The connection is not yet open.\n */WebSocketClient.CONNECTING=WebSocket.CONNECTING;/**\n * The connection is open and ready to communicate.\n */WebSocketClient.OPEN=WebSocket.OPEN;/**\n * The connection is in the process of closing.\n */WebSocketClient.CLOSING=WebSocket.CLOSING;/**\n * The connection is closed or couldn't be opened.\n */WebSocketClient.CLOSED=WebSocket.CLOSED;exports.default=WebSocketClient;","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar websocket_1 = require(\"@gamestdio/websocket\");\nvar msgpack = require(\"./msgpack\");\nvar Connection = /** @class */ (function (_super) {\n    __extends(Connection, _super);\n    function Connection(url, autoConnect) {\n        if (autoConnect === void 0) { autoConnect = true; }\n        var _this = _super.call(this, url, undefined, { connect: autoConnect }) || this;\n        _this._enqueuedCalls = [];\n        return _this;\n    }\n    Connection.prototype.onOpenCallback = function (event) {\n        _super.prototype.onOpenCallback.call(this);\n        this.binaryType = 'arraybuffer';\n        if (this._enqueuedCalls.length > 0) {\n            for (var _i = 0, _a = this._enqueuedCalls; _i < _a.length; _i++) {\n                var _b = _a[_i], method = _b[0], args = _b[1];\n                this[method].apply(this, args);\n            }\n            // clear enqueued calls.\n            this._enqueuedCalls = [];\n        }\n    };\n    Connection.prototype.send = function (data) {\n        if (this.ws.readyState === WebSocket.OPEN) {\n            return _super.prototype.send.call(this, msgpack.encode(data));\n        }\n        else {\n            // WebSocket not connected.\n            // Enqueue data to be sent when readyState == OPEN\n            this._enqueuedCalls.push(['send', [data]]);\n        }\n    };\n    return Connection;\n}(websocket_1.default));\nexports.Connection = Connection;\n","\"use strict\";\n// Use codes between 0~127 for lesser throughput (1 byte)\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Protocol;\n(function (Protocol) {\n    // User-related (0~10)\n    Protocol[Protocol[\"USER_ID\"] = 1] = \"USER_ID\";\n    // Room-related (10~20)\n    Protocol[Protocol[\"JOIN_ROOM\"] = 10] = \"JOIN_ROOM\";\n    Protocol[Protocol[\"JOIN_ERROR\"] = 11] = \"JOIN_ERROR\";\n    Protocol[Protocol[\"LEAVE_ROOM\"] = 12] = \"LEAVE_ROOM\";\n    Protocol[Protocol[\"ROOM_DATA\"] = 13] = \"ROOM_DATA\";\n    Protocol[Protocol[\"ROOM_STATE\"] = 14] = \"ROOM_STATE\";\n    Protocol[Protocol[\"ROOM_STATE_PATCH\"] = 15] = \"ROOM_STATE_PATCH\";\n    // Match-making related (20~29)\n    Protocol[Protocol[\"ROOM_LIST\"] = 20] = \"ROOM_LIST\";\n    // Generic messages (50~60)\n    Protocol[Protocol[\"BAD_REQUEST\"] = 50] = \"BAD_REQUEST\";\n})(Protocol = exports.Protocol || (exports.Protocol = {}));\n","\"use strict\";\nvar Clock = (function () {\n    function Clock(useInterval) {\n        if (useInterval === void 0) { useInterval = false; }\n        this.running = false;\n        this.now = (typeof (window) !== \"undefined\" && window.performance && window.performance.now && (window.performance.now).bind(window.performance)) || Date.now;\n        this.start(useInterval);\n    }\n    Clock.prototype.start = function (useInterval) {\n        if (useInterval === void 0) { useInterval = false; }\n        this.deltaTime = 0;\n        this.currentTime = this.now();\n        this.elapsedTime = 0;\n        this.running = true;\n        if (useInterval) {\n            // auto set interval to 60 ticks per second\n            this._interval = setInterval(this.tick.bind(this), 1000 / 60);\n        }\n    };\n    Clock.prototype.stop = function () {\n        this.running = false;\n        if (this._interval) {\n            clearInterval(this._interval);\n        }\n    };\n    Clock.prototype.tick = function (newTime) {\n        if (newTime === void 0) { newTime = this.now(); }\n        this.deltaTime = newTime - this.currentTime;\n        this.currentTime = newTime;\n        this.elapsedTime += this.deltaTime;\n    };\n    return Clock;\n}());\nmodule.exports = Clock;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction compare(tree1, tree2) {\n    var patches = [];\n    generate(tree1, tree2, patches, []);\n    return patches;\n}\nexports.compare = compare;\nfunction concat(arr, value) {\n    var newArr = arr.slice();\n    newArr.push(value);\n    return newArr;\n}\nfunction objectKeys(obj) {\n    if (Array.isArray(obj)) {\n        var keys_1 = new Array(obj.length);\n        for (var k = 0; k < keys_1.length; k++) {\n            keys_1[k] = \"\" + k;\n        }\n        return keys_1;\n    }\n    if (Object.keys) {\n        return Object.keys(obj);\n    }\n    var keys = [];\n    for (var i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            keys.push(i);\n        }\n    }\n    return keys;\n}\n;\n// Dirty check if obj is different from mirror, generate patches and update mirror\nfunction generate(mirror, obj, patches, path) {\n    var newKeys = objectKeys(obj);\n    var oldKeys = objectKeys(mirror);\n    var deleted = false;\n    for (var t = oldKeys.length - 1; t >= 0; t--) {\n        var key = oldKeys[t];\n        var oldVal = mirror[key];\n        if (obj.hasOwnProperty(key) && !(obj[key] === undefined && oldVal !== undefined && Array.isArray(obj) === false)) {\n            var newVal = obj[key];\n            if (typeof oldVal == \"object\" && oldVal != null && typeof newVal == \"object\" && newVal != null) {\n                generate(oldVal, newVal, patches, concat(path, key));\n            }\n            else {\n                if (oldVal !== newVal) {\n                    patches.push({\n                        operation: \"replace\",\n                        path: concat(path, key),\n                        value: newVal,\n                        previousValue: oldVal\n                    });\n                }\n            }\n        }\n        else {\n            patches.push({ operation: \"remove\", path: concat(path, key) });\n            deleted = true; // property has been deleted\n        }\n    }\n    if (!deleted && newKeys.length == oldKeys.length) {\n        return;\n    }\n    for (var t = newKeys.length - 1; t >= 0; t--) {\n        var key = newKeys[t];\n        if (!mirror.hasOwnProperty(key) && obj[key] !== undefined) {\n            var newVal = obj[key];\n            var addPath = concat(path, key);\n            // compare deeper additions\n            if (typeof newVal == \"object\" && newVal != null) {\n                generate({}, newVal, patches, addPath);\n            }\n            patches.push({ operation: \"add\", path: addPath, value: newVal });\n        }\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar compare_1 = require(\"./compare\");\nvar StateContainer = /** @class */ (function () {\n    function StateContainer(state) {\n        this.listeners = [];\n        this.matcherPlaceholders = {\n            \":id\": /^([a-zA-Z0-9\\-_]+)$/,\n            \":number\": /^([0-9]+)$/,\n            \":string\": /^(\\w+)$/,\n            \":axis\": /^([xyz])$/,\n            \":*\": /(.*)/,\n        };\n        this.state = state;\n        this.reset();\n    }\n    StateContainer.prototype.set = function (newState) {\n        var patches = compare_1.compare(this.state, newState);\n        this.state = newState;\n        this.checkPatches(patches, this.listeners, this.defaultListener);\n        return patches;\n    };\n    StateContainer.prototype.registerPlaceholder = function (placeholder, matcher) {\n        this.matcherPlaceholders[placeholder] = matcher;\n    };\n    StateContainer.prototype.listen = function (segments, callback, immediate) {\n        var _this = this;\n        var rules;\n        if (typeof (segments) === \"function\") {\n            rules = [];\n            callback = segments;\n        }\n        else {\n            rules = segments.split(\"/\");\n        }\n        if (callback.length > 1) {\n            console.warn(\".listen() accepts only one parameter.\");\n        }\n        var listener = {\n            callback: callback,\n            rawRules: rules,\n            rules: rules.map(function (segment) {\n                if (typeof (segment) === \"string\") {\n                    // replace placeholder matchers\n                    return (segment.indexOf(\":\") === 0)\n                        ? _this.matcherPlaceholders[segment] || _this.matcherPlaceholders[\":*\"]\n                        : new RegExp(\"^\" + segment + \"$\");\n                }\n                else {\n                    return segment;\n                }\n            })\n        };\n        if (rules.length === 0) {\n            this.defaultListener = listener;\n        }\n        else {\n            this.listeners.push(listener);\n        }\n        // immediatelly try to trigger this listener.\n        if (immediate) {\n            this.checkPatches(compare_1.compare({}, this.state), [listener]);\n        }\n        return listener;\n    };\n    StateContainer.prototype.removeListener = function (listener) {\n        for (var i = this.listeners.length - 1; i >= 0; i--) {\n            if (this.listeners[i] === listener) {\n                this.listeners.splice(i, 1);\n            }\n        }\n    };\n    StateContainer.prototype.removeAllListeners = function () {\n        this.reset();\n    };\n    StateContainer.prototype.checkPatches = function (patches, listeners, defaultListener) {\n        for (var j = 0, len = listeners.length; j < len; j++) {\n            var listener = listeners[j];\n            for (var i = patches.length - 1; i >= 0; i--) {\n                var pathVariables = listener && this.getPathVariables(patches[i], listener);\n                if (pathVariables) {\n                    listener.callback({\n                        path: pathVariables,\n                        rawPath: patches[i].path,\n                        operation: patches[i].operation,\n                        value: patches[i].value\n                    });\n                    patches[i].matched = true;\n                }\n            }\n        }\n        // trigger default listener callback with each unmatched patch\n        if (defaultListener) {\n            for (var i = patches.length - 1; i >= 0; i--) {\n                if (!patches[i].matched) {\n                    defaultListener.callback(patches[i]);\n                }\n            }\n        }\n    };\n    StateContainer.prototype.getPathVariables = function (patch, listener) {\n        // skip if rules count differ from patch\n        if (patch.path.length !== listener.rules.length) {\n            return false;\n        }\n        var path = {};\n        for (var i = 0, len = listener.rules.length; i < len; i++) {\n            var matches = patch.path[i].match(listener.rules[i]);\n            if (!matches || matches.length === 0 || matches.length > 2) {\n                return false;\n            }\n            else if (listener.rawRules[i].substr(0, 1) === \":\") {\n                path[listener.rawRules[i].substr(1)] = matches[1];\n            }\n        }\n        return path;\n    };\n    StateContainer.prototype.reset = function () {\n        this.listeners = [];\n    };\n    return StateContainer;\n}());\nexports.StateContainer = StateContainer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar StateContainer_1 = require(\"./StateContainer\");\nexports.StateContainer = StateContainer_1.StateContainer;\n","// Fossil SCM delta compression algorithm\n// ======================================\n//\n// Format:\n// http://www.fossil-scm.org/index.html/doc/tip/www/delta_format.wiki\n//\n// Algorithm:\n// http://www.fossil-scm.org/index.html/doc/tip/www/delta_encoder_algorithm.wiki\n//\n// Original implementation:\n// http://www.fossil-scm.org/index.html/artifact/d1b0598adcd650b3551f63b17dfc864e73775c3d\n//\n// LICENSE\n// -------\n//\n// Copyright 2014 Dmitry Chestnykh (JavaScript port)\n// Copyright 2007 D. Richard Hipp  (original C version)\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or\n// without modification, are permitted provided that the\n// following conditions are met:\n//\n//   1. Redistributions of source code must retain the above\n//      copyright notice, this list of conditions and the\n//      following disclaimer.\n//\n//   2. Redistributions in binary form must reproduce the above\n//      copyright notice, this list of conditions and the\n//      following disclaimer in the documentation and/or other\n//      materials provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY THE AUTHORS ``AS IS'' AND ANY EXPRESS\n// OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n// ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHORS OR CONTRIBUTORS BE\n// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR\n// BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n// WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n// OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n// EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation\n// are those of the authors and contributors and should not be interpreted\n// as representing official policies, either expressed or implied, of anybody\n// else.\n//\n(function(root, factory) {\n  if (typeof module !== 'undefined' && module.exports) module.exports = factory();\n  else root.fossilDelta = factory();\n})(this, function() {\n'use strict';\n\nvar fossilDelta = {};\n\n// Hash window width in bytes. Must be a power of two.\nvar NHASH = 16;\n\nfunction RollingHash() {\n  this.a = 0; // hash     (16-bit unsigned)\n  this.b = 0; // values   (16-bit unsigned)\n  this.i = 0; // start of the hash window (16-bit unsigned)\n  this.z = new Array(NHASH); // the values that have been hashed.\n}\n\n// Initialize the rolling hash using the first NHASH bytes of\n// z at the given position.\nRollingHash.prototype.init = function(z, pos) {\n  var a = 0, b = 0, i, x;\n  for(i = 0; i < NHASH; i++){\n    x = z[pos+i];\n    a = (a + x) & 0xffff;\n    b = (b + (NHASH-i)*x) & 0xffff;\n    this.z[i] = x;\n  }\n  this.a = a & 0xffff;\n  this.b = b & 0xffff;\n  this.i = 0;\n};\n\n// Advance the rolling hash by a single byte \"c\".\nRollingHash.prototype.next = function(c) {\n  var old = this.z[this.i];\n  this.z[this.i] = c;\n  this.i = (this.i+1)&(NHASH-1);\n  this.a = (this.a - old + c) & 0xffff;\n  this.b = (this.b - NHASH*old + this.a) & 0xffff;\n};\n\n// Return a 32-bit hash value.\nRollingHash.prototype.value = function() {\n  return ((this.a & 0xffff) | (this.b & 0xffff)<<16)>>>0;\n};\n\nvar zDigits = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz~\".\n                split('').map(function (x) { return x.charCodeAt(0); });\n\nvar zValue = [\n  -1, -1, -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1, -1, -1, -1, -1,\n  -1, -1, -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1, -1, -1, -1, -1,\n  -1, -1, -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1, -1, -1, -1, -1,\n   0,  1,  2,  3,  4,  5,  6,  7,    8,  9, -1, -1, -1, -1, -1, -1,\n  -1, 10, 11, 12, 13, 14, 15, 16,   17, 18, 19, 20, 21, 22, 23, 24,\n  25, 26, 27, 28, 29, 30, 31, 32,   33, 34, 35, -1, -1, -1, -1, 36,\n  -1, 37, 38, 39, 40, 41, 42, 43,   44, 45, 46, 47, 48, 49, 50, 51,\n  52, 53, 54, 55, 56, 57, 58, 59,   60, 61, 62, -1, -1, -1, 63, -1\n];\n\n// Reader reads bytes, chars, ints from array.\nfunction Reader(array) {\n  this.a = array; // source array\n  this.pos = 0;   // current position in array\n}\n\nReader.prototype.haveBytes = function() {\n  return this.pos < this.a.length;\n};\n\nReader.prototype.getByte = function() {\n  var b = this.a[this.pos];\n  this.pos++;\n  if (this.pos > this.a.length) throw new RangeError('out of bounds');\n  return b;\n};\n\nReader.prototype.getChar = function() {\n  return String.fromCharCode(this.getByte());\n};\n\n// Read base64-encoded unsigned integer.\nReader.prototype.getInt = function(){\n  var v = 0, c;\n  while(this.haveBytes() && (c = zValue[0x7f & this.getByte()]) >= 0) {\n     v = (v<<6) + c;\n  }\n  this.pos--;\n  return v >>> 0;\n};\n\n\n// Write writes an array.\nfunction Writer() {\n  this.a = [];\n}\n\nWriter.prototype.toArray = function() {\n  return this.a;\n};\n\nWriter.prototype.putByte = function(b) {\n  this.a.push(b & 0xff);\n};\n\n// Write an ASCII character (s is a one-char string).\nWriter.prototype.putChar = function(s) {\n  this.putByte(s.charCodeAt(0));\n};\n\n// Write a base64 unsigned integer.\nWriter.prototype.putInt = function(v){\n  var i, j, zBuf = [];\n  if (v === 0) {\n    this.putChar('0');\n    return;\n  }\n  for (i = 0; v > 0; i++, v >>>= 6)\n    zBuf.push(zDigits[v&0x3f]);\n  for (j = i-1; j >= 0; j--)\n    this.putByte(zBuf[j]);\n};\n\n// Copy from array at start to end.\nWriter.prototype.putArray = function(a, start, end) {\n  for (var i = start; i < end; i++) this.a.push(a[i]);\n};\n\n// Return the number digits in the base64 representation of a positive integer.\nfunction digitCount(v){\n  var i, x;\n  for (i = 1, x = 64; v >= x; i++, x <<= 6){ /* nothing */ }\n  return i;\n}\n\n// Return a 32-bit checksum of the array.\nfunction checksum(arr) {\n  var sum0 = 0, sum1 = 0, sum2 = 0, sum3 = 0,\n      z = 0, N = arr.length;\n  //TODO measure if this unrolling is helpful.\n  while (N >= 16) {\n    sum0 = sum0 + arr[z+0] | 0;\n    sum1 = sum1 + arr[z+1] | 0;\n    sum2 = sum2 + arr[z+2] | 0;\n    sum3 = sum3 + arr[z+3] | 0;\n\n    sum0 = sum0 + arr[z+4] | 0;\n    sum1 = sum1 + arr[z+5] | 0;\n    sum2 = sum2 + arr[z+6] | 0;\n    sum3 = sum3 + arr[z+7] | 0;\n\n    sum0 = sum0 + arr[z+8] | 0;\n    sum1 = sum1 + arr[z+9] | 0;\n    sum2 = sum2 + arr[z+10] | 0;\n    sum3 = sum3 + arr[z+11] | 0;\n\n    sum0 = sum0 + arr[z+12] | 0;\n    sum1 = sum1 + arr[z+13] | 0;\n    sum2 = sum2 + arr[z+14] | 0;\n    sum3 = sum3 + arr[z+15] | 0;\n\n    z += 16;\n    N -= 16;\n  }\n  while (N >= 4) {\n    sum0 = sum0 + arr[z+0] | 0;\n    sum1 = sum1 + arr[z+1] | 0;\n    sum2 = sum2 + arr[z+2] | 0;\n    sum3 = sum3 + arr[z+3] | 0;\n    z += 4;\n    N -= 4;\n  }\n  sum3 = (((sum3 + (sum2 << 8) | 0) + (sum1 << 16) | 0) + (sum0 << 24) | 0);\n  /* jshint -W086 */\n  switch (N) {\n    case 3: sum3 = sum3 + (arr[z+2] <<  8) | 0; /* falls through */\n    case 2: sum3 = sum3 + (arr[z+1] << 16) | 0; /* falls through */\n    case 1: sum3 = sum3 + (arr[z+0] << 24) | 0; /* falls through */\n  }\n  return sum3 >>> 0;\n}\n\n// Create a new delta from src to out.\nfossilDelta.create = function(src, out) {\n  var zDelta = new Writer();\n  var lenOut = out.length;\n  var lenSrc = src.length;\n  var i, lastRead = -1;\n\n  zDelta.putInt(lenOut);\n  zDelta.putChar('\\n');\n\n  // If the source is very small, it means that we have no\n  // chance of ever doing a copy command.  Just output a single\n  // literal segment for the entire target and exit.\n  if (lenSrc <= NHASH) {\n    zDelta.putInt(lenOut);\n    zDelta.putChar(':');\n    zDelta.putArray(out, 0, lenOut);\n    zDelta.putInt(checksum(out));\n    zDelta.putChar(';');\n    return zDelta.toArray();\n  }\n\n  // Compute the hash table used to locate matching sections in the source.\n  var nHash = Math.ceil(lenSrc / NHASH);\n  var collide =  new Array(nHash);\n  var landmark = new Array(nHash);\n  for (i = 0; i < collide.length; i++) collide[i] = -1;\n  for (i = 0; i < landmark.length; i++) landmark[i] = -1;\n  var hv, h = new RollingHash();\n  for (i = 0; i < lenSrc-NHASH; i += NHASH) {\n    h.init(src, i);\n    hv = h.value() % nHash;\n    collide[i/NHASH] = landmark[hv];\n    landmark[hv] = i/NHASH;\n  }\n\n  var base = 0;\n  var iSrc, iBlock, bestCnt, bestOfst, bestLitsz;\n  while (base+NHASH<lenOut) {\n    bestOfst=0;\n    bestLitsz=0;\n    h.init(out, base);\n    i = 0; // Trying to match a landmark against zOut[base+i]\n    bestCnt = 0;\n    while(1) {\n      var limit = 250;\n      hv = h.value() % nHash;\n      iBlock = landmark[hv];\n      while (iBlock >= 0 && (limit--)>0 ) {\n        //\n        // The hash window has identified a potential match against\n        // landmark block iBlock.  But we need to investigate further.\n        //\n        // Look for a region in zOut that matches zSrc. Anchor the search\n        // at zSrc[iSrc] and zOut[base+i].  Do not include anything prior to\n        // zOut[base] or after zOut[outLen] nor anything after zSrc[srcLen].\n        //\n        // Set cnt equal to the length of the match and set ofst so that\n        // zSrc[ofst] is the first element of the match.  litsz is the number\n        // of characters between zOut[base] and the beginning of the match.\n        // sz will be the overhead (in bytes) needed to encode the copy\n        // command.  Only generate copy command if the overhead of the\n        // copy command is less than the amount of literal text to be copied.\n        //\n        var cnt, ofst, litsz;\n        var j, k, x, y;\n        var sz;\n\n        // Beginning at iSrc, match forwards as far as we can.\n        // j counts the number of characters that match.\n        iSrc = iBlock*NHASH;\n        for (j = 0, x = iSrc, y = base+i; x < lenSrc && y < lenOut; j++, x++, y++) {\n          if (src[x] !== out[y]) break;\n        }\n        j--;\n\n        // Beginning at iSrc-1, match backwards as far as we can.\n        // k counts the number of characters that match.\n        for (k = 1; k < iSrc && k <= i; k++) {\n          if (src[iSrc-k] !== out[base+i-k]) break;\n        }\n        k--;\n\n        // Compute the offset and size of the matching region.\n        ofst = iSrc-k;\n        cnt = j+k+1;\n        litsz = i-k;  // Number of bytes of literal text before the copy\n        // sz will hold the number of bytes needed to encode the \"insert\"\n        // command and the copy command, not counting the \"insert\" text.\n        sz = digitCount(i-k)+digitCount(cnt)+digitCount(ofst)+3;\n        if (cnt >= sz && cnt > bestCnt) {\n          // Remember this match only if it is the best so far and it\n          // does not increase the file size.\n          bestCnt = cnt;\n          bestOfst = iSrc-k;\n          bestLitsz = litsz;\n        }\n\n        // Check the next matching block\n        iBlock = collide[iBlock];\n      }\n\n      // We have a copy command that does not cause the delta to be larger\n      // than a literal insert.  So add the copy command to the delta.\n      if (bestCnt > 0) {\n        if (bestLitsz > 0) {\n          // Add an insert command before the copy.\n          zDelta.putInt(bestLitsz);\n          zDelta.putChar(':');\n          zDelta.putArray(out, base, base+bestLitsz);\n          base += bestLitsz;\n        }\n        base += bestCnt;\n        zDelta.putInt(bestCnt);\n        zDelta.putChar('@');\n        zDelta.putInt(bestOfst);\n        zDelta.putChar(',');\n        if (bestOfst + bestCnt -1 > lastRead) {\n          lastRead = bestOfst + bestCnt - 1;\n        }\n        bestCnt = 0;\n        break;\n      }\n\n      // If we reach this point, it means no match is found so far\n      if (base+i+NHASH >= lenOut){\n        // We have reached the end and have not found any\n        // matches.  Do an \"insert\" for everything that does not match\n        zDelta.putInt(lenOut-base);\n        zDelta.putChar(':');\n        zDelta.putArray(out, base, base+lenOut-base);\n        base = lenOut;\n        break;\n      }\n\n      // Advance the hash by one character. Keep looking for a match.\n      h.next(out[base+i+NHASH]);\n      i++;\n    }\n  }\n  // Output a final \"insert\" record to get all the text at the end of\n  // the file that does not match anything in the source.\n  if(base < lenOut) {\n    zDelta.putInt(lenOut-base);\n    zDelta.putChar(':');\n    zDelta.putArray(out, base, base+lenOut-base);\n  }\n  // Output the final checksum record.\n  zDelta.putInt(checksum(out));\n  zDelta.putChar(';');\n  return zDelta.toArray();\n};\n\n// Return the size (in bytes) of the output from applying a delta.\nfossilDelta.outputSize = function(delta){\n  var zDelta = new Reader(delta);\n  var size = zDelta.getInt();\n  if (zDelta.getChar() !== '\\n')\n    throw new Error('size integer not terminated by \\'\\\\n\\'');\n  return size;\n};\n\n// Apply a delta.\nfossilDelta.apply = function(src, delta, opts) {\n  var limit, total = 0;\n  var zDelta = new Reader(delta);\n  var lenSrc = src.length;\n  var lenDelta = delta.length;\n\n  limit = zDelta.getInt();\n  if (zDelta.getChar() !== '\\n')\n    throw new Error('size integer not terminated by \\'\\\\n\\'');\n  var zOut = new Writer();\n  while(zDelta.haveBytes()) {\n    var cnt, ofst;\n    cnt = zDelta.getInt();\n\n    switch (zDelta.getChar()) {\n      case '@':\n        ofst = zDelta.getInt();\n        if (zDelta.haveBytes() && zDelta.getChar() !== ',')\n          throw new Error('copy command not terminated by \\',\\'');\n        total += cnt;\n        if (total > limit)\n          throw new Error('copy exceeds output file size');\n        if (ofst+cnt > lenSrc)\n          throw new Error('copy extends past end of input');\n        zOut.putArray(src, ofst, ofst+cnt);\n        break;\n\n      case ':':\n        total += cnt;\n        if (total > limit)\n          throw new Error('insert command gives an output larger than predicted');\n        if (cnt > lenDelta)\n          throw new Error('insert count exceeds size of delta');\n        zOut.putArray(zDelta.a, zDelta.pos, zDelta.pos+cnt);\n        zDelta.pos += cnt;\n        break;\n\n      case ';':\n        var out = zOut.toArray();\n        if ((!opts || opts.verifyChecksum !== false) && cnt !== checksum(out))\n          throw new Error('bad checksum');\n        if (total !== limit)\n          throw new Error('generated size does not match predicted size');\n        return out;\n\n      default:\n        throw new Error('unknown delta operator');\n    }\n  }\n  throw new Error('unterminated delta');\n};\n\nreturn fossilDelta;\n\n});\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  for (var i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Clock = require(\"@gamestdio/clock\");\nvar signals_1 = require(\"@gamestdio/signals\");\nvar state_listener_1 = require(\"@gamestdio/state-listener\");\nvar fossilDelta = require(\"fossil-delta\");\nvar msgpack = require(\"./msgpack\");\nvar Connection_1 = require(\"./Connection\");\nvar Protocol_1 = require(\"./Protocol\");\nvar Room = /** @class */ (function (_super) {\n    __extends(Room, _super);\n    function Room(name, options) {\n        var _this = _super.call(this, {}) || this;\n        _this.clock = new Clock(); // experimental\n        _this.remoteClock = new Clock(); // experimental\n        // Public signals\n        _this.onJoin = new signals_1.Signal();\n        _this.onStateChange = new signals_1.Signal();\n        _this.onMessage = new signals_1.Signal();\n        _this.onError = new signals_1.Signal();\n        _this.onLeave = new signals_1.Signal();\n        _this.id = null;\n        _this.name = name;\n        _this.options = options;\n        _this.connection = new Connection_1.Connection(undefined, false);\n        _this.onLeave.add(function () { return _this.removeAllListeners(); });\n        return _this;\n    }\n    Room.prototype.connect = function (endpoint) {\n        var _this = this;\n        this.connection.url = endpoint;\n        this.connection.reconnectEnabled = false;\n        this.connection.onmessage = this.onMessageCallback.bind(this);\n        this.connection.onclose = function (e) { return _this.onLeave.dispatch(e); };\n        this.connection.onerror = function (e) {\n            console.warn(\"Possible causes: room's onAuth() failed or maxClients has been reached.\");\n            _this.onError.dispatch(e);\n        };\n        this.connection.open();\n    };\n    Room.prototype.leave = function () {\n        if (this.connection) {\n            this.connection.send([Protocol_1.Protocol.LEAVE_ROOM]);\n        }\n        else {\n            this.onLeave.dispatch();\n        }\n    };\n    Room.prototype.send = function (data) {\n        this.connection.send([Protocol_1.Protocol.ROOM_DATA, this.id, data]);\n    };\n    Room.prototype.removeAllListeners = function () {\n        _super.prototype.removeAllListeners.call(this);\n        this.onJoin.removeAll();\n        this.onStateChange.removeAll();\n        this.onMessage.removeAll();\n        this.onError.removeAll();\n        this.onLeave.removeAll();\n    };\n    Room.prototype.onMessageCallback = function (event) {\n        var message = msgpack.decode(new Uint8Array(event.data));\n        var code = message[0];\n        if (code === Protocol_1.Protocol.JOIN_ROOM) {\n            this.sessionId = message[1];\n            this.onJoin.dispatch();\n        }\n        else if (code === Protocol_1.Protocol.JOIN_ERROR) {\n            console.error(\"Error: \" + message[1]);\n            this.onError.dispatch(message[1]);\n        }\n        else if (code === Protocol_1.Protocol.ROOM_STATE) {\n            var state = message[1];\n            var remoteCurrentTime = message[2];\n            var remoteElapsedTime = message[3];\n            this.setState(state, remoteCurrentTime, remoteElapsedTime);\n        }\n        else if (code === Protocol_1.Protocol.ROOM_STATE_PATCH) {\n            this.patch(message[1]);\n        }\n        else if (code === Protocol_1.Protocol.ROOM_DATA) {\n            this.onMessage.dispatch(message[1]);\n        }\n        else if (code === Protocol_1.Protocol.LEAVE_ROOM) {\n            this.leave();\n        }\n    };\n    Room.prototype.setState = function (encodedState, remoteCurrentTime, remoteElapsedTime) {\n        var state = msgpack.decode(encodedState);\n        this.set(state);\n        this._previousState = new Uint8Array(encodedState);\n        // set remote clock properties\n        if (remoteCurrentTime && remoteElapsedTime) {\n            this.remoteClock.currentTime = remoteCurrentTime;\n            this.remoteClock.elapsedTime = remoteElapsedTime;\n        }\n        this.clock.start();\n        this.onStateChange.dispatch(state);\n    };\n    Room.prototype.patch = function (binaryPatch) {\n        // apply patch\n        this._previousState = Buffer.from(fossilDelta.apply(this._previousState, binaryPatch));\n        // trigger state callbacks\n        this.set(msgpack.decode(this._previousState));\n        this.onStateChange.dispatch(this.state);\n    };\n    return Room;\n}(state_listener_1.StateContainer));\nexports.Room = Room;\n","\"use strict\";\n/**\n * We do not assign 'storage' to window.localStorage immediatelly for React\n * Native compatibility. window.localStorage is not present when this module is\n * loaded.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction getStorage() {\n    return (typeof (cc) !== 'undefined' && cc.sys && cc.sys.localStorage)\n        ? cc.sys.localStorage // compatibility with cocos creator\n        : window.localStorage; // regular browser environment\n}\nfunction setItem(key, value) {\n    getStorage().setItem(key, value);\n}\nexports.setItem = setItem;\nfunction getItem(key, callback) {\n    var value = getStorage().getItem(key);\n    if (typeof (Promise) === 'undefined' || // old browsers\n        !(value instanceof Promise)) {\n        // browser has synchronous return\n        callback(value);\n    }\n    else {\n        // react-native is asynchronous\n        value.then(function (id) { return callback(id); });\n    }\n}\nexports.getItem = getItem;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar signals_1 = require(\"@gamestdio/signals\");\nvar msgpack = require(\"./msgpack\");\nvar Connection_1 = require(\"./Connection\");\nvar Protocol_1 = require(\"./Protocol\");\nvar Room_1 = require(\"./Room\");\nvar Storage_1 = require(\"./Storage\");\nvar Client = /** @class */ (function () {\n    function Client(url) {\n        var _this = this;\n        // signals\n        this.onOpen = new signals_1.Signal();\n        this.onMessage = new signals_1.Signal();\n        this.onClose = new signals_1.Signal();\n        this.onError = new signals_1.Signal();\n        this.rooms = {};\n        this.connectingRooms = {};\n        this.requestId = 0;\n        this.roomsAvailableRequests = {};\n        this.hostname = url;\n        Storage_1.getItem('colyseusid', function (colyseusid) { return _this.connect(colyseusid); });\n    }\n    Client.prototype.join = function (roomName, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        options.requestId = ++this.requestId;\n        var room = this.createRoom(roomName, options);\n        // remove references on leaving\n        room.onLeave.addOnce(function () {\n            delete _this.rooms[room.id];\n            delete _this.connectingRooms[options.requestId];\n        });\n        this.connectingRooms[options.requestId] = room;\n        this.connection.send([Protocol_1.Protocol.JOIN_ROOM, roomName, options]);\n        return room;\n    };\n    Client.prototype.rejoin = function (roomName, sessionId) {\n        return this.join(roomName, { sessionId: sessionId });\n    };\n    Client.prototype.getAvailableRooms = function (roomName, callback) {\n        var _this = this;\n        // reject this promise after 10 seconds.\n        var requestId = ++this.requestId;\n        var removeRequest = function () { return delete _this.roomsAvailableRequests[requestId]; };\n        var rejectionTimeout = setTimeout(function () {\n            removeRequest();\n            callback([], 'timeout');\n        }, 10000);\n        // send the request to the server.\n        this.connection.send([Protocol_1.Protocol.ROOM_LIST, requestId, roomName]);\n        this.roomsAvailableRequests[requestId] = function (roomsAvailable) {\n            removeRequest();\n            clearTimeout(rejectionTimeout);\n            callback(roomsAvailable);\n        };\n    };\n    Client.prototype.close = function () {\n        this.connection.close();\n    };\n    Client.prototype.createRoom = function (roomName, options) {\n        if (options === void 0) { options = {}; }\n        return new Room_1.Room(roomName, options);\n    };\n    Client.prototype.connect = function (colyseusid) {\n        var _this = this;\n        this.id = colyseusid || '';\n        this.connection = new Connection_1.Connection(this.buildEndpoint());\n        this.connection.onmessage = this.onMessageCallback.bind(this);\n        this.connection.onclose = function (e) { return _this.onClose.dispatch(e); };\n        this.connection.onerror = function (e) { return _this.onError.dispatch(e); };\n        // check for id on cookie\n        this.connection.onopen = function () {\n            if (_this.id) {\n                _this.onOpen.dispatch();\n            }\n        };\n    };\n    Client.prototype.buildEndpoint = function (path, options) {\n        if (path === void 0) { path = ''; }\n        if (options === void 0) { options = {}; }\n        // append colyseusid to connection string.\n        var params = [\"colyseusid=\" + this.id];\n        for (var name_1 in options) {\n            if (!options.hasOwnProperty(name_1)) {\n                continue;\n            }\n            params.push(name_1 + \"=\" + options[name_1]);\n        }\n        return this.hostname + \"/\" + path + \"?\" + params.join('&');\n    };\n    /**\n     * @override\n     */\n    Client.prototype.onMessageCallback = function (event) {\n        var message = msgpack.decode(new Uint8Array(event.data));\n        var code = message[0];\n        if (code === Protocol_1.Protocol.USER_ID) {\n            Storage_1.setItem('colyseusid', message[1]);\n            this.id = message[1];\n            this.onOpen.dispatch();\n        }\n        else if (code === Protocol_1.Protocol.JOIN_ROOM) {\n            var requestId = message[2];\n            var room = this.connectingRooms[requestId];\n            if (!room) {\n                console.warn('colyseus.js: client left room before receiving session id.');\n                return;\n            }\n            room.id = message[1];\n            this.rooms[room.id] = room;\n            room.connect(this.buildEndpoint(room.id, room.options));\n            delete this.connectingRooms[requestId];\n        }\n        else if (code === Protocol_1.Protocol.JOIN_ERROR) {\n            console.error('colyseus.js: server error:', message[2]);\n            // general error\n            this.onError.dispatch(message[2]);\n        }\n        else if (code === Protocol_1.Protocol.ROOM_LIST) {\n            if (this.roomsAvailableRequests[message[1]]) {\n                this.roomsAvailableRequests[message[1]](message[2]);\n            }\n            else {\n                console.warn('receiving ROOM_LIST after timeout:', message[2]);\n            }\n        }\n        else {\n            this.onMessage.dispatch(message);\n        }\n    };\n    return Client;\n}());\nexports.Client = Client;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar helpers_1 = require(\"./helpers\");\nfunction assign(instance, property, propName, value, key) {\n    if (property.holderType === 'var') {\n        instance[propName] = value;\n    }\n    else if (property.holderType === 'key') {\n        // mapListener only\n        instance[propName] = key;\n    }\n}\nfunction assignMultiple(instance, properties, value, key) {\n    for (var prop in properties) {\n        if (!properties.hasOwnProperty(prop)) {\n            continue;\n        }\n        assign(instance, properties[prop], prop, value[prop], key);\n    }\n}\nfunction getInstanceContainer(root, path, offset) {\n    if (offset === void 0) { offset = 0; }\n    var instance = root;\n    for (var i = 0, len = path.length; i < len + offset; i++) {\n        if (typeof (instance[path[i]]) !== 'object') {\n            break;\n        }\n        instance = instance[path[i]];\n    }\n    return instance;\n}\nfunction objectListener(room, property, synchable, synchableRoot, parentSegment) {\n    return function (change) {\n        if (change.operation === 'add') {\n            var newType = new property.type();\n            // assign all variables to new instance type\n            for (var prop in change.value) {\n                if (!change.value.hasOwnProperty(prop)) {\n                    continue;\n                }\n                newType[prop] = change.value[prop];\n            }\n            // bind @listen annotations\n            helpers_1.bindListeners(property.type.listeners, room, newType);\n            synchable[property.variable] = newType;\n            if (property.addCallback) {\n                property.addCallback.call(synchableRoot, synchableRoot, newType, change);\n            }\n        }\n        else if (change.operation === 'replace') {\n            synchableRoot[this.rawRules[0]][property.variable] = change.value;\n        }\n        else if (change.operation === 'remove') {\n            if (property.removeCallback) {\n                property.removeCallback.call(synchableRoot, synchableRoot, synchable[property.variable][change.path.id], change);\n            }\n            delete synchable[property.variable];\n        }\n    };\n}\nexports.objectListener = objectListener;\nfunction mapListener(room, property, synchable, synchableRoot, parentSegment) {\n    return function (change) {\n        var instance = getInstanceContainer(synchableRoot, change.rawPath);\n        if (change.operation === 'add') {\n            var newType = new property.type();\n            // define __mapParent as non-enumerable.\n            Object.defineProperty(newType, '__mapParent', {\n                configurable: true,\n                enumerable: false,\n                value: getInstanceContainer(synchableRoot, change.rawPath, -2),\n                writable: true,\n            });\n            // bind @listen annotations\n            helpers_1.bindListeners(property.type.listeners, room, newType);\n            instance[change.path.id] = newType;\n            // assign all variables to new instance type\n            assignMultiple(newType, property.type.properties, change.value, change.path.id);\n            if (property.addCallback) {\n                property.addCallback.call(newType.__mapParent, newType.__mapParent, newType, change);\n            }\n        }\n        else if (change.operation === 'replace') {\n            assign(instance, property, property.variable, change.value);\n        }\n        else if (change.operation === 'remove') {\n            if (property.removeCallback) {\n                property.removeCallback.call(instance.__mapParent, instance.__mapParent, instance, change);\n            }\n            delete synchable[property.variable][change.path.id];\n        }\n    };\n}\nexports.mapListener = mapListener;\nfunction varListener(room, property, synchable, synchableRoot, parentSegment) {\n    return function (change) {\n        var target = getInstanceContainer(synchableRoot, change.rawPath);\n        if (change.operation !== 'remove') {\n            assign(target, property, property.variable, change.value);\n        }\n        else if (change.operation === 'remove') {\n            delete target[property.variable];\n        }\n    };\n}\nexports.varListener = varListener;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar listeners = require(\"./listeners\");\nfunction initializeSync(roomInstance, synchable) {\n    createBindings(roomInstance, synchable, synchable);\n}\nexports.initializeSync = initializeSync;\nfunction syncMap(type, addCallback, removeCallback) {\n    return sync(type, 'map', addCallback, removeCallback);\n}\nexports.syncMap = syncMap;\nfunction syncObject(type, addCallback, removeCallback) {\n    return sync(type, 'object', addCallback, removeCallback);\n}\nexports.syncObject = syncObject;\nfunction syncVar(type, addCallback, removeCallback) {\n    return sync(type, 'var');\n}\nexports.syncVar = syncVar;\nfunction syncList(type, addCallback, removeCallback) {\n    return sync(type, 'list', addCallback, removeCallback);\n}\nexports.syncList = syncList;\nfunction key() {\n    return sync(undefined, 'key');\n}\nexports.key = key;\nfunction room() {\n    return function (proto, attr) {\n        Object.defineProperty(proto, attr, {\n            configurable: true,\n            enumerable: true,\n            get: function () { return proto.constructor.$room; },\n        });\n    };\n}\nexports.room = room;\nfunction sync(type, holderType, addCallback, removeCallback) {\n    if (holderType === void 0) { holderType = 'var'; }\n    return function (target, propertyKey) {\n        if (!target.constructor.properties) {\n            target.constructor.properties = {};\n        }\n        var variable = propertyKey;\n        if (typeof (type) === 'string') {\n            variable = propertyKey;\n            propertyKey = type;\n            type = undefined;\n        }\n        target.constructor.properties[propertyKey] = {\n            addCallback: addCallback,\n            holderType: holderType,\n            removeCallback: removeCallback,\n            type: type,\n            variable: variable,\n        };\n    };\n}\nexports.sync = sync;\nfunction listen(path, op) {\n    return function (target, methodName, descriptor) {\n        if (!target.constructor.listeners) {\n            target.constructor.listeners = {};\n        }\n        target.constructor.listeners[path] = { methodName: methodName, op: op };\n    };\n}\nexports.listen = listen;\nvar listenersMap = {};\nfunction createBindings(roomInstance, synchable, synchableRoot, parentSegment) {\n    bindProperties(synchable.constructor.properties || synchable.properties, roomInstance, synchable, synchableRoot, parentSegment);\n    bindListeners(synchable.constructor.listeners, roomInstance, synchable);\n}\nexports.createBindings = createBindings;\nfunction bindProperties(properties, roomInstance, synchable, synchableRoot, parentSegment) {\n    // no properties to sync\n    if (!properties) {\n        return;\n    }\n    // room reference\n    Object.defineProperty(synchable, '$room', {\n        configurable: true,\n        enumerable: false,\n        value: roomInstance,\n        writable: true,\n    });\n    synchable.$room = roomInstance;\n    // create bindings for properties\n    for (var segment in properties) {\n        if (!properties.hasOwnProperty(segment)) {\n            continue;\n        }\n        var property = properties[segment];\n        var path = (parentSegment)\n            ? parentSegment + \"/\" + segment\n            : segment;\n        if (property.holderType === 'map') {\n            path += '/:id';\n        }\n        // skip if duplicate listenersMap\n        if (listenersMap[path]) {\n            return;\n        }\n        else {\n            listenersMap[path] = true;\n        }\n        var listener = listeners[property.holderType + \"Listener\"];\n        if (listener) {\n            roomInstance.listen(path, listener(roomInstance, property, synchable, synchableRoot, path));\n            if (property.type) {\n                createBindings(roomInstance, property.type, synchable, path);\n            }\n        }\n    }\n}\nfunction bindListeners(listenersToBind, roomInstance, synchable) {\n    if (!listenersToBind) {\n        return;\n    }\n    var _loop_1 = function (path) {\n        if (!listenersToBind.hasOwnProperty(path)) {\n            return \"continue\";\n        }\n        var listener = listenersToBind[path];\n        var callback = (listener.op)\n            ? (function (change) {\n                if (change.operation === listener.op) {\n                    synchable[listener.methodName](change);\n                }\n            })\n            : synchable[listener.methodName].bind(synchable);\n        roomInstance.listen(path, callback);\n    };\n    for (var path in listenersToBind) {\n        _loop_1(path);\n    }\n}\nexports.bindListeners = bindListeners;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"./legacy\");\nvar Client_1 = require(\"./Client\");\nexports.Client = Client_1.Client;\nvar Protocol_1 = require(\"./Protocol\");\nexports.Protocol = Protocol_1.Protocol;\nvar Room_1 = require(\"./Room\");\nexports.Room = Room_1.Room;\n/**\n * Experimental sync helpers\n */\nvar helpers_1 = require(\"./sync/helpers\");\nexports.initializeSync = helpers_1.initializeSync;\nexports.sync = helpers_1.sync;\nexports.syncMap = helpers_1.syncMap;\nexports.syncObject = helpers_1.syncObject;\nexports.syncVar = helpers_1.syncVar;\nexports.syncList = helpers_1.syncList;\nexports.key = helpers_1.key;\nexports.room = helpers_1.room;\nexports.listen = helpers_1.listen;\n","// NOTE: Cleint needs to npm i colyseus.js (yes, .js is the client version of colyseus)\r\n// Browsers can't require because they don't have access to the file system so compiling \r\n// your code with webpack or something like that will take your required and make one \r\n// large file that holds the colyseus code. See: https://parceljs.org/\r\n// run npm i -g parcel-bundler\r\n// npm init -y\r\n// npm i colyseus.js\r\n// parcel index.html -p 8080 (or it defaults to 1234 if you don't define a -p)\r\nconst Colyseus = require(\"colyseus.js\");\r\n\r\nlet client = new Colyseus.Client(\"ws://localhost:4000\");\r\n\r\nlet room = client.join(\"battle\");\r\n\r\nroom.onJoin.add(() => {\r\n  console.log(\"client joined successfully\");\r\n});"]}